<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>马拉松程序员项目演示</title>
    <link rel="stylesheet" href="/static/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="/static/js/jqPaginator.min.js" type="text/javascript"></script>
    <link rel="Shortcut Icon" href="/static/img/mlscoder.ico" type="image/x-icon"/>

</head>

<body>

<style>
    .title {
        font-size: 25px;
        padding: 10px;
        margin-bottom: 30px;
    }

    .city {
        font-size: 20px;
        padding: 10px;
        margin-bottom: 30px;
    }

    .blog {
        font-size: 18px;
        padding: 10px;
        margin-bottom: 30px;
    }

    .w70 {
        display: inline-block;
    }

    .item {
        float: left;
        margin-left: 20px;
        margin-bottom: 20px;
    }
</style>
<div class="container">

    <h3 class="title"><strong>多城市租房(中介)分类演示</strong> <a href="/">搜房源</a>
        <span class="city">&nbsp; &nbsp; 当前<span style="color: red">{{cityName}}</span> &nbsp;&nbsp;切换
      <a href="/agent?city=sh">上海</a>|<a href="/agent?city=bj">北京</a>|<a href="/agent?city=gz">广州</a>|<a href="/agent?city=sz">深圳</a>|<a
                    href="/agent?city=hz">杭州</a>|<a href="/agent?city=nj">南京</a>|<a href="/agent?city=wh">武汉</a>|<a
                    href="/agent?city=cq">重庆</a>|<a href="/agent?city=cd">成都</a>
        </span>
        <span class="blog"><a href="https://www.mlscoder.cn">站长博客</a></span>
    </h3>

    <div class="controls clearfix">
        <form method="post" id="myForm">


            <div class="item">
                地铁站点：
                <select class="form-control-select" id="line" name="line" onchange="selectCity(this)">
                    <option>线路</option>
                    {% for line in lines %}
                    <option {%if lineName== line %}
                            selected="selected" {% endif %}> {{ line }}
                    </option>
                    {% endfor %}
                </select>
                <select class="form-control-select" id="station" name="station">
                    <option>站点</option>
                </select>
            </div>
            <div>
                <input type="hidden" id="cityCode" value="{{cityCode}}">
                <input type="hidden" id="lineName" value="{{lineName}}">
                <input type="hidden" id="stationName" value="{{station}}">
                <input type="hidden" id="currentPage" name="currentPage" value="{{currentPage}}"/>
                <button type="submit" id="submit" class="item btn btn-primary">查询</button>
            </div>
        </form>
    </div>
    <div class="content table-responsive">
        <table class="table table-bordered table-hover table-condensed table-striped">
            <thead>
            <th>序号</th>
            <th>站点</th>
            <th>最近周度发帖数</th>
            <th>最近月底发帖数</th>
            <th>最近季度发帖数</th>
            <th>最近更新时间</th>
            <th width="400px">最近更新帖子(可能是非搜索站点)</th>
            <th>详情</th>
            </thead>
            <tbody>
            {% if rents==None %}
            <span>当前条件未查询到记录</span>
            {% else %}
            {% for rent in rents %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ rent[0]}}</td>
                <td>{{ rent[1]}}</td>
                <td>{{ rent[2]}}</td>
                <td>{{ rent[3]}}</td>
                <td>{{ rent[4]}}</td>
                <td>{{ rent[5]}}</td>
                <td><a href="{{ rent[6] }}" target="_blank">查看</a></td>
            </tr>
            {% endfor %}
            {% endif %}
            </tbody>
        </table>
    </div>
    <div>
        <ul class="pagination" id="pagination">
        </ul>
        <!--所有的数据条数-->
        <input type="hidden" id="PageCount" value="{{pageCount}}"/>
        <!--每页条数-->
        <input type="hidden" id="PageSize" value="{{pageSize}}"/>
        <!--一共多少页-->
        <input type="hidden" id="countindex"/>
        <script src="/static/js/myPage.js" type="text/javascript"></script>
    </div>

</div>

<script type="text/javascript">
    $(document).ready(function () {
        var lineName = $("#lineName").val();
        var stationName = $("#stationName").val();
        var cityCode = $("#cityCode").val();
        $.ajax({
            type: "GET",
            url: "getSubwayStation?city=" + cityCode + "&line=" + lineName,
            dataType: "json",
            success: function (data) {
                console.log(data)
                var citys = data;
                var oCitySele = document.getElementById("station");
                var opts = oCitySele.getElementsByTagName("option");
                var len = opts.length;//4 3
                for (var i = 1; i < len; i++) {
                    oCitySele.removeChild(opts[1]);
                }
                for (var i = 0; i < citys.length; i++) {
                    var opt = document.createElement("option");
                    opt.innerHTML = citys[i];
                    if (stationName == citys[i]) {
                        opt.selected = true;
                    }
                    oCitySele.appendChild(opt);
                }
            }
        });

    });
</script>
<script type="text/javascript">
    function selectCity(thisobj) {
        var prov = thisobj.value;
        var stationName = $("#stationName").val();
        var cityCode = $("#cityCode").val();
        $.ajax({
            type: "GET",
            url: "getSubwayStation?city=" + cityCode + "&line=" + prov,
            dataType: "json",
            success: function (data) {
                console.log(data)
                var citys = data;
                var oCitySele = document.getElementById("station");
                var opts = oCitySele.getElementsByTagName("option");
                var len = opts.length;//4 3
                for (var i = 1; i < len; i++) {
                    oCitySele.removeChild(opts[1]);
                }
                for (var i = 0; i < citys.length; i++) {
                    var opt = document.createElement("option");
                    opt.innerHTML = citys[i];
                    if (stationName == citys[i]) {
                        opt.selected = true;
                    }
                    oCitySele.appendChild(opt);
                }
            }
        });
    }
</script>
<script type="text/javascript">document.write(unescape("%3Cspan id='cnzz_stat_icon_1278096247'%3E%3C/span%3E%3Cscript src='https://s4.cnzz.com/z_stat.php%3Fid%3D1278096247%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</body>
</html>